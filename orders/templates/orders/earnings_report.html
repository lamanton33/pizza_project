<!-- orders/templates/orders/earnings_report.html -->
{% extends 'orders/base.html' %}

{% block title %}Earnings Report{% endblock %}

{% block content %}
    <h2>Earnings Report</h2>
    <form method="get">
        <label>Region:</label>
        <input type="text" name="region" value="{{ request.GET.region }}"><br>

        <label>Gender:</label>
        <select name="gender">
            <option value="">All</option>
            <option value="M" {% if request.GET.gender == 'M' %}selected{% endif %}>Male</option>
            <option value="F" {% if request.GET.gender == 'F' %}selected{% endif %}>Female</option>
        </select><br>

        <label>Age Group:</label>
        <input type="text" name="age_group" value="{{ request.GET.age_group }}"><br><br>

        <button type="submit">Filter</button>
    </form>

    {% if reports %}
        <table>
            <tr>
                <th>Month</th>
                <th>Total Earnings</th>
                <th>Number of Orders</th>
                <th>Total Spent</th>
                <th>Region</th>
                <th>Customer Gender</th>
                <th>Customer Age Group</th>
            </tr>
            {% for report in reports %}
                <tr>
                    <td>{{ report.report_month|date:"Y-m" }}</td>
                    <td>${{ report.total_earnings|floatformat:2 }}</td>
                    <td>{{ report.number_of_orders }}</td>
                    <td>${{ report.total_spent|floatformat:2 }}</td>
                    <td>{{ report.region }}</td>
                    <td>{{ report.get_customer_gender_display }}</td>
                    <td>{{ report.customer_age_group }}</td>
                </tr>
            {% endfor %}
        </table>
    {% else %}
        <p>No earnings reports available.</p>
    {% endif %}
{% endblock %}
